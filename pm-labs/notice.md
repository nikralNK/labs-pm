# Лабораторная работа 23: Работа с файлами и массивами

## Описание работы программы

Приложение предназначено для создания, анализа и сохранения одномерных массивов с возможностью работы с файлами. Реализовано 10 различных заданий для работы с массивами.

## Компоненты формы

1. **txtN** - TextBox для ввода размера массива
2. **btnGenerate** - кнопка генерации массива случайных чисел
3. **grpTask** - GroupBox с радиокнопками для выбора задания
4. **rbTask1-rbTask10** - RadioButton для выбора одного из 10 заданий
5. **lstArray** - ListBox для отображения элементов массива
6. **btnAnalyze** - кнопка выполнения выбранного задания
7. **txtResults** - многострочный TextBox для вывода результатов
8. **btnSave** - кнопка сохранения массива в файл
9. **btnLoad** - кнопка загрузки массива из файла
10. **btnClear** - кнопка очистки всех данных
11. **saveFileDialog1** - диалог сохранения файла
12. **openFileDialog1** - диалог открытия файла

## Основные методы

### btnGenerate_Click

Метод генерации массива случайных чисел:

1. Проверяет, введен ли размер массива
2. Проверяет, что размер - число от 1 до 1000
3. Создает массив указанного размера
4. Заполняет массив случайными числами от -100 до 100
5. Выводит элементы массива в ListBox

### btnAnalyze_Click

Метод выполнения выбранного задания:

1. Проверяет существование массива
2. Определяет, какая радиокнопка выбрана
3. Вызывает соответствующий метод Task1-Task10
4. Очищает txtResults перед выводом результата

## Реализованные задания

### Task1 - Задание 1

Определяет количество отрицательных чисел, количество положительных чисел и среднее арифметическое всех чисел.

Алгоритм:
1. Проходит по всем элементам массива
2. Подсчитывает отрицательные (num < 0) и положительные (num > 0)
3. Суммирует все элементы
4. Вычисляет среднее: sum / array.Length

### Task2 - Задание 2

Формирует два массива: первый с элементами с четными индексами, второй - с нечетными. Вычисляет суммы элементов каждого массива.

Алгоритм:
1. Создает массив evenIndices размером Length/2 + Length%2
2. Создает массив oddIndices размером Length/2
3. Распределяет элементы по индексу: i%2==0 - четный, иначе - нечетный
4. Вычисляет суммы обоих массивов
5. Выводит оба массива и их суммы

### Task3 - Задание 3

Определяет среднее арифметическое первого отрицательного и последнего положительного элементов.

Алгоритм:
1. Ищет первый отрицательный элемент (с флагом foundNegative)
2. Ищет последний положительный элемент (обновляется при каждом нахождении)
3. Проверяет, что оба элемента найдены
4. Вычисляет среднее: (firstNegative + lastPositive) / 2.0

### Task4 - Задание 4

Определяет число отрицательных элементов перед наибольшим положительным элементом.

Алгоритм:
1. Находит максимальный положительный элемент и его индекс
2. Проверяет, что положительный элемент найден
3. Подсчитывает отрицательные элементы с индексом меньше maxPositiveIndex
4. Выводит максимальный элемент, его индекс и количество отрицательных

### Task5 - Задание 5

Меняет местами первый и последний положительные элементы.

Алгоритм:
1. Находит индекс первого положительного элемента
2. Находит индекс последнего положительного элемента
3. Проверяет, что найдено минимум два положительных элемента
4. Меняет элементы местами через temp
5. Обновляет отображение массива в ListBox

### Task6 - Задание 6

Вычисляет сумму и среднее арифметическое для массива из 10 элементов.

Алгоритм:
1. Проверяет, что массив содержит ровно 10 элементов
2. Суммирует все элементы
3. Вычисляет среднее: sum / 10.0
4. Выводит сумму и среднее

### Task7 - Задание 7

Вычисляет сумму положительных элементов массива из 20 элементов.

Алгоритм:
1. Проверяет, что массив содержит ровно 20 элементов
2. Проходит по массиву, суммируя только положительные элементы (num > 0)
3. Выводит сумму

### Task8 - Задание 8

Вычисляет сумму четных элементов массива из 20 элементов.

Алгоритм:
1. Проверяет, что массив содержит ровно 20 элементов
2. Проходит по массиву, суммируя только четные элементы (num % 2 == 0)
3. Выводит сумму

### Task9 - Задание 9

Определяет количество положительных элементов массива из 20 элементов.

Алгоритм:
1. Проверяет, что массив содержит ровно 20 элементов
2. Подсчитывает количество положительных элементов (num > 0)
3. Выводит количество

### Task10 - Задание 10

Определяет индексы положительных элементов массива из 20 элементов.

Алгоритм:
1. Проверяет, что массив содержит ровно 20 элементов
2. Создает список indices
3. Проходит по массиву, добавляя индексы положительных элементов
4. Проверяет, что найден хотя бы один положительный элемент
5. Выводит индексы через запятую

### btnSave_Click

Метод сохранения массива в файл:

1. Проверяет наличие данных для сохранения
2. Открывает диалог сохранения файла (saveFileDialog1.ShowDialog())
3. Создает StreamWriter для записи в файл
4. Записывает в первую строку размер массива
5. Записывает каждый элемент массива в отдельную строку
6. Закрывает файл с помощью using
7. Показывает сообщение об успешном сохранении

### btnLoad_Click

Метод загрузки массива из файла:

1. Открывает диалог выбора файла (openFileDialog1.ShowDialog())
2. Создает StreamReader для чтения файла
3. Читает первую строку - размер массива
4. Проверяет корректность размера
5. Создает новый массив
6. Читает элементы массива построчно
7. Проверяет корректность каждого числа
8. Заполняет массив и ListBox считанными данными
9. Обновляет поле txtN значением размера
10. В случае ошибки показывает сообщение

### btnClear_Click

Метод очистки всех данных:

1. Устанавливает array в null
2. Очищает lstArray.Items
3. Очищает txtResults
4. Очищает txtN

## Настройка диалогов

**SaveFileDialog**:
- DefaultExt = "txt" - расширение по умолчанию
- Filter - фильтр типов файлов (*.txt и все файлы)
- Title - заголовок окна

**OpenFileDialog**:
- Те же настройки, что и SaveFileDialog

## Формат файла

```
размер_массива
элемент_1
элемент_2
...
элемент_N
```

Первая строка содержит размер массива, каждая последующая строка - один элемент массива.

## Особенности реализации

1. Используется поле класса `private int[] array` для хранения массива
2. Генерация случайных чисел: `rand.Next(-100, 101)` - от -100 до 100 включительно
3. Валидация входных данных перед каждой операцией
4. Использование `using` для автоматического закрытия файловых потоков
5. Обработка исключений при чтении файла в блоке try-catch
6. Вывод результата анализа с форматированием: `{average:F2}` - два знака после запятой
