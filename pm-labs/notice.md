# Лабораторная работа 23: Работа с файлами и массивами

## Описание работы программы

Приложение предназначено для создания, анализа и сохранения одномерных массивов с возможностью работы с файлами.

## Компоненты формы

1. **txtN** - TextBox для ввода размера массива
2. **btnGenerate** - кнопка генерации массива случайных чисел
3. **lstArray** - ListBox для отображения элементов массива
4. **btnAnalyze** - кнопка анализа массива
5. **txtResults** - многострочный TextBox для вывода результатов анализа
6. **btnSave** - кнопка сохранения массива в файл
7. **btnLoad** - кнопка загрузки массива из файла
8. **btnClear** - кнопка очистки всех данных
9. **saveFileDialog1** - диалог сохранения файла
10. **openFileDialog1** - диалог открытия файла

## Основные методы

### btnGenerate_Click

Метод генерации массива случайных чисел:

1. Проверяет, введен ли размер массива
2. Проверяет, что размер - число от 1 до 1000
3. Создает массив указанного размера
4. Заполняет массив случайными числами от -100 до 100
5. Выводит элементы массива в ListBox

### btnAnalyze_Click

Метод анализа массива:

1. Проверяет существование массива
2. Подсчитывает количество отрицательных элементов
3. Подсчитывает количество положительных элементов
4. Вычисляет сумму всех элементов
5. Вычисляет среднее арифметическое: sum / array.Length
6. Выводит результаты в txtResults

### btnSave_Click

Метод сохранения массива в файл:

1. Проверяет наличие данных для сохранения
2. Открывает диалог сохранения файла (saveFileDialog1.ShowDialog())
3. Создает StreamWriter для записи в файл
4. Записывает в первую строку размер массива
5. Записывает каждый элемент массива в отдельную строку
6. Закрывает файл с помощью using
7. Показывает сообщение об успешном сохранении

### btnLoad_Click

Метод загрузки массива из файла:

1. Открывает диалог выбора файла (openFileDialog1.ShowDialog())
2. Создает StreamReader для чтения файла
3. Читает первую строку - размер массива
4. Проверяет корректность размера
5. Создает новый массив
6. Читает элементы массива построчно
7. Проверяет корректность каждого числа
8. Заполняет массив и ListBox считанными данными
9. Обновляет поле txtN значением размера
10. В случае ошибки показывает сообщение

### btnClear_Click

Метод очистки всех данных:

1. Устанавливает array в null
2. Очищает lstArray.Items
3. Очищает txtResults
4. Очищает txtN

## Настройка диалогов

**SaveFileDialog**:
- DefaultExt = "txt" - расширение по умолчанию
- Filter - фильтр типов файлов (*.txt и все файлы)
- Title - заголовок окна

**OpenFileDialog**:
- Те же настройки, что и SaveFileDialog

## Формат файла

```
размер_массива
элемент_1
элемент_2
...
элемент_N
```

Первая строка содержит размер массива, каждая последующая строка - один элемент массива.

## Особенности реализации

1. Используется поле класса `private int[] array` для хранения массива
2. Генерация случайных чисел: `rand.Next(-100, 101)` - от -100 до 100 включительно
3. Валидация входных данных перед каждой операцией
4. Использование `using` для автоматического закрытия файловых потоков
5. Обработка исключений при чтении файла в блоке try-catch
6. Вывод результата анализа с форматированием: `{average:F2}` - два знака после запятой
